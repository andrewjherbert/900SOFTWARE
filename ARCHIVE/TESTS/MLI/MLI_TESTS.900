ML/I TEST -- NAMES
TESTS INITIAL STATE OF BUILT IN TABLES
SHOULD BE USED AS THE FIRST REAL TEST OF A NEW IMPLEMENTATION
MCNOINS.MCNOSKIP.MCNODEF.MCNOWARN.SB....
MAKE ALL OTHERS UNMATCHED
MCSTOP MCWARN MCWARNG MCSKIP MCSKIPG,MCDEF
MCINS,MCINSG MCALTER TO TO MCDEF VARS
MCNOTE MCGO MCPVAR MCDEFG AS MCSUB(,,
MCSET=MCGO IF MCGO UNLESS EN MCLENG   (

)

ML/I TEST -- ESCALATE
TESTS GRADUALLY MORE COMPLICATED CONSTRUCTIONS
NOT COMPREHENSIVE, BUT USEFUL AS GENERAL OVERALL TEST
MCLENG(A)MCLENG(MCLENG(ABCDEFHIJK))MCSUB(AB34C,3,4)MCDEF:AS 56
:MCLENG(:ABCDE )MCDEF 56 AS 89
: SB 123456789
MCSKIP MT,<>
<1>MCINS U,%.
%2.%2+1.%9-5.%350/70.%3*2.%1+2*3.%10-6/3.%55/3/2. SB 123456789
%5-6.%23.%4/1.%10/2.%5-5. SB -123450
MCDEF MAC; AS <%A1.>
MAC 1 ;MAC 23;MCSET P1=9*5
%P1.MCGO L1
X%L1.67<>MCSET P2=MAC 79; + MAC 10;
%P2. SB 123456789
MCDEFG /WITH/AS 12
//MCSKIPG D,3
3<>MCDEF //AS%6-2.
12<>MCDEF<:> SPACE AS<<56>>
MCDEFG<:> OPT; OR PIG ALL AS 89
: %: /8.MCNODEF:X; SB 123456789
MCDEF 1 N1 OPT 2 N1 OR 2 WITHS 3 ALL
AS<% WD 0 .%D1.%A1.%A2.5%%B3.-3.MCSKIP SPACE
%% D T1 .+55. 9>
1 3 2 %2+2.2<9>2 3 SB 123456789
MCSKIP D,< 1 >
MCGO L%3-2. IF: X PIG=89
X%L1.MCGO L2 UNLESS S1+3 EN P1-42
1%L2.MCDEF SL AS 23
MCSET S1=1
4<>MCSET S1=1-S1
5<>MCPVAR 11
MCSET P11=P11+67
%P11.MCDEF MACRO 8 N0 AS
MACRO X 8<>MCALTER AS TO IS
MCDEF PIG AS IS SUBMAC
MCALTER IS TO AS
MCDEF SUBMAC AS 9
PIG AS SB 123456789

)

ML/I TEST -- ALTER
TESTS MC-ALTER (BUT RESETS ENVIRONMENT SO LATER TESTS NOT AFFECTED)
MCINS%.
MCSKIP MT,<>
MCALTER<TO>TO< >
MCALTER<>AS :
MCDEF MAC1:1
MCALTER< > TO
MCALTER=TO A
MCSET P1 A 2
MCALTER:TO AS
MCDEF MAC2 AS 3
MCGO ERROR UNLESS MAC1%P1.MAC2 A 123
MCALTER MCALTER B TO C
C TO MCALTER A TO B
=
MCSET P2=6
MCALTER,TO.
MCINS U.INS.
MCSKIP MT.SKIP.
INS SKIP 1..MCSUB(X23Y.P2-4.P2-3)MCALTER.TO,
MCINS U,INSS.
MCSKIP MT,SKIPP.
INSS SKIPP 4..MCSUB(5,1,0) SB 12345
MCALTER SPACE TO SP
MCALTER N TO M
MCALTER M TO 9
MCALTER ALL TO AL
MCALTER WITHS TO+
MCDEF MAC3 91 OPT SP 91 OR END+END AL AS<%T1.>
MCALTER 9 TO N
MCALTER AL TO ALL
MCALTER SP TO SPACE
MCALTER+TO WITHS
MCDEF MAC4 N1 OPT SPACE N1 OR END WITHS END ALL AS<%T1.>
MAC4 END END<>MAC3  END  END SB 23
TRY ERRORS (NOTE THAT ON AN IMPLEMENTATION WITH ALIGNMENT THE FIRST
 TWO WILL NOT GIVE ERRORS)
1.MCALTER=TO EQ
2.MCALTER EQ TO =
3.MCALTER TO X
4.MCALTER GE TO
5.MCALTER N TO.
6.MCALTER GE TO G.
7.MCALTER , TO VERYLONGINDEED
 SB 1.2.3.4.5.6.7.

)

ML/I TEST -- MACROTIME
TESTS MACRO EXPRESSIONS AND MACRO-TIME STATEMENTS
MACROS TESTED ARE: MC-GO,MC-SET,MCSUB,MCLENG,MC-PVAR,MC-NOTE
MCDEF T2VAL AS %T2.
MCINS%.
T2VAL SB 3 (THIS WILL BE WRONG IF EXTRA CALLS HAVE BEEN ADDED)
MCGO ERROR PVARS UNLESS%P1.%P2.%P3.%P4.%P5.=00000
MCGO  ERROR PVARS UNLESS%P6.%P7.%P8.%P9.%P10.=00000
MCSET P10=2
MCSKIP MT,<>
MCSKIP NONL WITHS NL
MCSET P1=6
MCSUB(X1X,MCLENG(AB),MCLENG(A)+1 )MCSUB(X23,P1/3,0)NONL
MCSUB(4X,-1,1)MCSUB(MCSUB (5XX ,1,-1),1,-1) SB 12345
MCSUB(,1,1)MCSUB( A ,1,2)MCSUB(AB,2,1)MCSUB(A,1,-1)NONL
MCSUB(A,P1,P1)MCLENG()MCLENG(MCLENG(A)) SB 01
MCSET P1=3
MCSET SP1=3
MCSET P2=20
MCSET PS3=1
%P3.%PP1 +1.%+4*+--3-27/3.%16/2/2.%-P2 /-4.%PPPP1+5. SB 123456
MCSET MCSET P4=5
 PP4=MCSET P6=%%1..
% %%P6...
%7/4.%4/4.%3/4.%-1/-4.%3/-4.%-1/4.%-8/4.%7/-4. SB 1100-1-1-2-2
SUCCESSFUL GOTOS
MCGO L1
1%L1.MCGO L1 UNLESS 1+1 EN 1
2%L1.MCGO L%1234.IF=
3%L1234.MCGO L MCGO L1
X%L1.1 IF P1 GE P1-1
4%L1.MCGO L1 UNLESS XXA =XXB
5%L1.MCGO L1 IF P3 GE P3
6%L1.MCGO L2-1 IF P3+1 GE P3
7%L1.NOW TRY UNSUCCESSFUL GOS
MCGO LA IF<A >=A
MCGO LB UNLESS 1 EN 1
MCGO LC IF 60 GR %60.
MCGO LD IF 6 GR 7
MCGO LE IF 71 GE 72
TRY GOS WITHIN MACRO
MCDEF GOMACRO; AS<MCGO L1
% L 2.%T1-1.MCGO L3
%%A1..MCGO L2
%L3.%TP1.MCSET T3=T3+1
MCGO L3 IF 3 GE T3
MCGO L0
%L3.>
GOMACRO L1; SB 0123
MCPVAR 50
MCPVAR%5+5.
%P50.%P11+1.%P10.%P1. SB 0123
TEST BC ON MC-GO
1<>MCGO L1 IF A BC L
1%L1.MCGO L1 IF ZZAZ BC<  L  >
2%L1.MCGO L1 IF 0090 BC N
3%L1.MCGO L1 IF-+0123456789 BC N
4%L1 .MCGO L1 UNLESS Z90A-BC I
5%L1.MCGO L1 IF ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789 BC I
6%L1.MCGO LL IF A0 BC L
MCGO LM IF BC I
MCGO LN IF+-BC N
MCGO LP IF+BC L
MCGO LQ IF 1+1 BC N
MCNOTE THIS IS A MC-NOTE MESSAGE FROM LINE %S2+1. OF SOURCE TEXT
MCDEF NOTEST;
AS<MCNOTE A MC-NOTE WITHIN THE MACRO <NOTEST>
%A1.MCSET S4=1
MCNOTE NO ENVIRONMENT SHOULD BE PRINTED WITH THIS MC-NOTE
>
NOTEST MCNOTE A MC-NOTE WITHIN AN ARGUMENT TO <NOTEST>
;%3+%2.-%1.-2. SB 12

)

ML/I TEST -- OVERFLOW
TESTS STACK OVERFLOW, USING ENDLESS RECURSION
DEPTH OF NESTING REACHED BEFORE OVERFLOW OCCURS WILL
 VARY BETWEEN IMPLEMENTATIONS
MCDEF 1000 VARS PIG AS PIG
PIG
THIS LINE SHOULD NEVER BE REACHED

)

ML/I TEST -- OVERRIDE
TESTS OVERRIDING, GLOBALS AND LOCALS,MC-NO MACROS AND WARNINGS
MCINSG%.
MCSKIPG MT,<>
MCDEF A AS 1
MCDEF TEST AS<MCDEF<A> AS 5
MCDEF NEST AS<MCDEF<A> AS 2
MCDEFG <A> AS RUBBISH
MCDEFG<A> AS 3
MCDEFG A7 AS%A+5.
A<>MCNODEF<>A<>MCDEF<A>AS 4
A<>MCWARN<A>
>
NEST<>A>
A<>TEST<>MCNODEF%A+3.A7 SB 1234567
MCSKIP <A>
MCDEF<A> AS RUBBISH
MCINS<A>.
MCWARN<A>
%A MCNOWARN  3-3.A MCNOWARN<>MCNOINS<>MCSUB  (
,2,1)MCNODEF<>MCNOSKIP<>MCDEF X AS 1
MCDEF MCDEF X AS 2
X AS X+<X>
MCDEF<X> AS 0
%2.<2>MCSKIP M MCDEF A AS T
A,MCSKIP+
MCDEF<X>AS/
+X+X
A/45/MCDEF P AS<MCDEF<P> AS 6
P<>MCWARN <P>
P A7>
P SB 01234567
MCNODEF<>MCNOSKIP<>MCSKIP T,' '
MCDEF<%.> AS 1
MCINS<%.>
MCSKIP<%.>
MCWARN '%'
%%XXX.%MCNOWARN<>MCWARN:
%THIS IS SKIPPED.:%ARG.:MCNOSKIP%22-21.%:%ARG.. SB 1111
:MCNOWARN<>MCDEF L WITHS M AS 2
MCDEF L WITHS M WITHS<%> WITHS 3 WITH  . AS 5
MCDEF L AS 1
L L M %3 . 4 L M%3. SB 1 2 3 4 5
MCDEF 4 WITHS 5 WITHS 6 N0
AS<MCWARNG:
%12-11. :MCSUB(Z2 3Z,10-8,4) >
MCSKIP 3 WITHS 4.
MCINS 3 WITHS 4.
MCWARN 3 WITHS 4
3 4 MCSKIP 2 3 WITH SPACE
2 SKIPPED 3 4 5<>3 4 MCNOWARN<>2 SKIPPED 3  4 5 SB 4 5 4 5
MCSKIP M,1 4 N0
MCDEF 3 WITHS 4 WITHS 5 END AS RUBBISH
1 D 3 4 5 3 4 . 4 5 6 SB :MCLENG(Z) <2 3 4 5 6>
:MCNOSKIP:MCSET S3=1
:<1>::MCLENG(AB):MCNODEF:%3*1.:MCSET S3=0
:MCNOWARN:MCSKIPG D,<:>
 SB :1:2:3

)

ML/I TEST -- S
TESTS S-VARIABLES,STARTLINES,STOP MARKERS AND COUNTING OF LINES
MCSKIP MT,<>
MCINS U,%.
MCGO ERROR1 UNLESS%S1.%S3.%S4.%S5.=0000
MCGO ERROR2 UNLESS%S6.%S7.%S8.%S9.=0000
MCSKIP /WITHS NL
1<>MCSET S1=1
2<>MCDEF SL
AS 3
MCSKIP D,SL
MCSUB(AN ERROR MESSAGE WITH SL IN,/
 SB (SL),2)MCSET S1=0
 SB 123
MCSET S2=0
%S2./
%S2.MCDEF THREENL NL WITHS NL WITHS NL AS<MCSET S2=S2-3
%S2.>
THREENL


%S2.MCDEF SLASHNL/WITHS NL N0 AS<%S2.>
SLASHNL X/
%S2. SB 123456
MCDEF MACRONL OPT NL N1 OR N1 X WITHS NL OR
NL WITHS NL WITHS OK OR 2 N0 ALL N1 AS<1>
MCSTOP NL
MACRONL
X


OK X 2%3.<4> SB 1234
MACRONL
THIS LINE CONTAINS 4 MISMATCHES: MCGO%<
MCDEF STRSCAN/SSAS RUBBISH
THIS SHOULD CAUSE AN ERROR ON THE NEXT LINE: MCGO L12
LINE IGNORED
THIS SHOULD CAUSE 4 ERRORS ON THE NEXT LINE BUT ONE: MCGO L1
MCGO L2
%MCSUB(STRSCAN .....
MCSKIP D,NL
MCSKIP 2 WITHS 3 5 WITHS 6
MCDEF STOPMAC END
AS<MCNOSKIP%A1.MCSTOP SPACE
MCGO ERROR UNLESS MCLENG(5 6) EN 3
>
MCSTOP 5 WITHS 6
STOPMAC 1 2 3 4 5 6 7 END SB 1 2 %3. 4 5 6 7
MCDEFG 5 WITHS 6 AS 1
0<>STOPMAC THIS SHOULD GIVE A MISMATCH 5 6<>2 SB 012

)

ML/I TEST -- SKIPINS
TESTS SKIPS AND INSERTS
MCSKIPG MT,<>
MCSKIP GONE
MCSKIP,/WITH++WITH/
MCSKIP MMTDDT,A B
MCSKIP D,<MCPVAR>
GONE/+DDD<+/MCSUB(MCPVAR,-1,-1)<A>B>A/+MCDEF+/B/+
+/ SB MCNOSKIP<>AA>BA/+MC<>DEF+/B
MCSKIP TTT,NOPUNCT N1 OPT,N1 OR .N1 OR END ALL
NOPUNCT,A,B,CD..E,.F END SB ABCDEF
MCINS P,%WITH P .
MCINS U,%WITH U.
MCINSG U,%WITH GU.
MCINS %.
MCDEF 2 AS MCDEF 4 AS 1
4
MCDEF 3 4
AS<%A MCDEF 1 AS 6
7-1.MCDEF SPACE AS /
%U B1.%%A1.+1./%WAT1./%WD0./%%WDT1.-1./MCDEF 4 AS 5
%DT1./%P DT1./%GU DT1./%U DT1.>
3 2 4<>MCSKIP D,<OPT 2 OR 3 ALL>
 SB 1/1/2/2/3/3/4/4/5/5
MCDEF FACTORIAL;
AS<MCGO L1 IF%A1.GR 1
1<>MCGO L0
%L   1   .%%A1.*FACTORIAL%%A1.-1.;.>
FACTORIAL 1;%FACTORIAL 4;-1. SB 123

)

ML/I TEST -- STRUCTURES
TESTS DELIMITER STRUCTURES AND SCANNING MECHANISM
MCINS%.
MCSKIP MT,<>
MCWARN CALL WITHS THIS WITHS MACRO
CALL THIS MACRO MCLENG (X)CALL THIS MACRO MCSET P1=1
CALL THIS MACRO   MCNOWARN<>MCDEF A WITHS B WITH SPACE WITH C
AS<MCSET P1=P1+1
%P1.>
A B C<>A   B C<45>MCLENG(A B  C) SB 123456
MCDEF 9 WITH.WITH 2 AS 1
9.2<>MCSUB(9. 2,9.2+3,4)3<>MCLENG(9 .2)MCDEF USEN1 N 1
AS<%3+T1.%7-%D2..>
USEN1 XX N XX 1 SB 123456
MCDEF MAC1 N1 OPT 7 N0 OR=OR=WITH SPACE OR=WITH. OR
=WITHS.WITH+OR=WITH.WITH-ALL N1
AS<%B1.%B2.%B3.%B4.%A4+1.%A6.>
MAC1<>1=2= 3=.4= .+5=.-6 7 SB 1234567
MCDEF MAC2 WITHS SPACE AS 1
MCDEF MAC3 WITH SPACES AS 23
MCSKIP MAC4 WITHS SPACES
MCDEF SPACE WITH MAC5 AS 4
MCDEF SPACES WITH MAC6 AS 5
MCINS SPACES WITH MAC7.
MAC2 MAC3   MAC4   <> MAC5   MAC6 MAC7 4+2. SB 123456
MCDEF TWONL NL WITHS NL AS 1
TWONL

MCDEF N000123 TWICE OPT X N123 OR 6 ALL N00
AS<%A1.%A2.%A3.%%DT1.-1.>
TWICE 2 X 3 TWICE 4 6 SB 123456
MCDEF STR,(SSAS<%A1.>
STR 1,MCDEF%<MCSUB(MCDEF STR2 2 N0 SSAS
MCDEF 34 SSAS<%WD0.>
STR2 STR%<MCSKIP 2<>34 SB 1234
MCNODEF<>MCDEF-20 VARS VM1 AS<%T3.>
MCDEFG 10 VARS VM2;AS<MCSET T10=1+VM1
%T10-T1.>
VM1<>VM2 XX;MCDEF EXCL1 4 N0 AS<%%D1.-%A1..>
MCDEFG 4 WITHS EXCL2 WITHS + AS<MCSUB(%WD0.,1,1)5>
MCSKIP SK 4 N0
MCDEF UNEXCL 4 AS<%A1.>
EXCL1 EXCL1 3 SK 4 EXCL2+UNEXCL EXCL1-2 4 SB 123456
MCSKIP 89 9 N0
MCSKIP D,9 OPT 9 OR 99 ALL N0
89 X 9 X 9 X 99 SB 9999
MCDEF STRUCT N1 OPT D1 OPT D11 OR D12 N2
ALL N1 OR N9 D2 N2 OPT D22 N9 OR D23 ALL ALL
AS<%A1.%A2.%A3.%A4.%A5.%A6.%A7.>
STRUCT 1 D1 2 D11 3 D1 4 D12 5 D22 6 D2 7 D23 SB 1234567
MCDEF 1234 WITHS NL WITHS BEYOND AS NEVER MATCHED
MCDEF OPT STR2 OR STR4 OPT STR23 OPT STR24 ALL ALL ALL
AS <%1+T1.MCSUB(%WD0.,0,0)>
STR2<>STR4 STR23 STR24 SB 1234

)

ML/I TEST -- ERRORS
CHECKS DETECTION OF ERRORS
MCSKIP MT,<>
MCINS%.
MCWARN 1
1 2 1 MCNOWARN<>MCSET P1=3/0
MCSUB(%L1.%L2.3.MCGO L3
%L1.,1%T1.,1) SB 1 2 3
MCDEF EXCLUSIVE OPT CANT OR WONT ALL AS RUBBISH
MCDEF 4 VARS ARGERR;SSAS<1%A1.3%T5.4>
ARGERR 2<>EXCLUSIVE XXX; SB 1234
MCSET  1=0
MCSET P1+1=0
1%A1.%P0.2%T1.%L0.3%.%L1A.4%LPIG.5% L.6%P+1. SB 123456
1<>MCGO
MCGO L0
2<>MCGO L
3<>MCGO L1A
4 SB 1234
1%/6.%*6.2%4/+-/3.%4*/6.3%5*.%-*-1.4%-4+/6. SB 1234
MCDEF ERRMAC NL
AS<1%A0.%B2.%W.%WD-1.2%D2.%WD.%T0.%T4.3%D1
.%A1.6%WT1.%WWD0.%DD1.>
ERRMAC %A1.4%%A1.+5.
MCNOINS<>MCNODEF<>MCNOSKIP SB 123456
A QUICK WAY TO VERIFY THAT ALL THE FOLLOWING ERRORS HAVE BEEN
DETECTED IS TO CHECK THAT THE ENVIRONMENT AT THE END CONTAINS
ONLY ONE MACRO,INSERT,STOP,SKIP AND WARNING.
1.MCSTOP
MCSTOP XX N0
MCSTOP X1 X2
MCSTOP OPT X OR Y ALL
2.MCINS INSERT TWO ARGUMENTS
MCINS NOARGUMENTS
3.MCSKIP
MCSKIP R2 OR+ALL
MCSKIP R3 ALL
MCSKIP OPT N1 R4 ALL
MCSKIP OPT OPT R5 ALL ALL
MCSKIP OPT R6 OR N2 OPT+ALL ALL
MCSKIP R7+N1+N1+
MCSKIP OPT R8 N1 ALL
MCSKIP N1 OPT R9 N1 ALL
MCSKIP N1 OPT R10 N1 OR +N0 ALL +
MCSKIP N1 OPT R11 N1 OR-OPT+N1ALL ALL +
MCSKIP R12 N1 N2
MCSKIP OPT R13 OR N1 N2+ALL
MCSKIP R14 OPT ALL
MCSKIP OPT R15 OR N1 ALL
MCSKIP OPT R16 OR +
MCSKIP R17 N10A
MCSKIP R18 N0 A
MCSKIP R19 N10
4.MCSKIP B WITHS WITH
MCSKIP C WITHS WITHS
MCSKIP D WITHS OPT
MCSKIP E WITHS OR
MCSKIP F WITHS ALL
MCSKIP G WITHS N1
MCSKIP H WITH
MCSKIP I N1 WITH.
MCSKIP J OPT WITH.ALL
MCSKIP K OPT.OR WITHS. ALL
MCDEF L OPT+ ALL WITH .AS
MCDEF M OPT A WITH.WITH B OR A WITHS . WITHS B ALL  AS
5.MCSKIP OPT A OR A ALL
MCSKIP OPT A OR B N0 OR C OR B ALL
MCSKIP OPT SPACE OR B OPT C ALL OR SPACES ALL
MCSKIP OPT A WITHS . WITHS B OR C OR A WITH.WITH B ALL
MCSKIP OPT A WITH SPACE WITH C OR A WITHS C ALL
MCSKIP OPT A WITH SPACE WITH . OR A WITHS. ALL
MCSKIP OPT SPACE WITH SPACE OR SPACES ALL
MCSKIP OPT A WITH SPACES OR A WITH SPACE WITH SPACE WITH SPACE ALL
MCSKIP OPT SPACES OR SPACES ALL
MCDEF OPT SPACE WITHS C WITHS. OR SPACE WITH SPACE WITH
 C WITH SPACE WITH. ALL AS RUBBISH
 SB 1.2.3.4.5.
MCDEF MCDEF + AS WITHS
THIS + SHOULD + BE + THE + ONLY + MACRO
AS MCDEF +AS WITHS
THIS + SHOULD + BE + THE + ONLY +
MCSTOP THIS SHOULD BE THE ONLY MACRO STOP
MCINS THIS SHOULD BE THE ONLY MACRO INSERT .
MCSKIP THIS SHOULD BE THE ONLY MACRO SKIP
MCWARN THIS SHOULD BE THE ONLY MACRO WARNING WITHS MARKER

)